<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تخصيص المنيو - WeenRest</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%23111'/%3E%3Cpath fill='%23f59e0b' d='M22 10h4v20c0 6-4 8-4 8s-4-2-4-8V10h4zM38 10h4v14h6v4h-6v10h-4V10z'/%3E%3C/svg%3E">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .field { margin-bottom: 1rem; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- Header (same as main site) -->
    <header class="bg-gradient-to-r from-gray-900 to-black shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-4 space-x-reverse">
                    <div class="w-12 h-12 bg-gradient-to-r from-yellow-600 to-amber-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-utensils text-white text-xl"></i>
                    </div>
                    <h1 class="text-white text-2xl font-bold">WeenRest</h1>
                </div>

                <!-- Navigation Menu -->
                <nav class="hidden md:flex items-center space-x-8 space-x-reverse">
                    <a href="index.html" class="text-white hover:text-yellow-400 transition duration-300 font-medium">الرئيسية</a>
                    <a href="places.html" class="text-white hover:text-yellow-400 transition duration-300 font-medium">أصناف الطعام</a>
                    <a href="#" class="text-white hover:text-yellow-400 transition duration-300 font-medium">وظائف</a>
                    <a href="customize.html" id="customize-restaurant-nav" class="text-white hover:text-yellow-400 transition duration-300 font-medium">خصص مطعمك</a>
                </nav>

                <!-- Login & Signup Buttons (Hidden when logged in) -->
                <div class="flex items-center space-x-4 space-x-reverse" id="auth-buttons">
                    <a href="signup.html" class="border-2 border-yellow-600 text-yellow-600 px-6 py-2 rounded-full font-semibold hover:bg-yellow-600 hover:text-white transition duration-300">
                        إنشاء حساب
                    </a>
                    <a href="login.html" class="bg-gradient-to-r from-yellow-600 to-amber-600 text-white px-6 py-2 rounded-full font-semibold hover:from-yellow-700 hover:to-amber-700 transition duration-300 shadow-md">
                        تسجيل الدخول
                    </a>
                    <!-- Mobile Menu Button -->
                    <button class="md:hidden text-white text-2xl" id="mobile-menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>

                <!-- User Info (Shown when logged in) -->
                <div class="flex items-center space-x-4 space-x-reverse hidden" id="user-info">
                    <div class="flex items-center space-x-3 space-x-reverse text-white">
                        <i class="fas fa-user-circle text-2xl text-yellow-400"></i>
                        <div class="hidden md:block">
                            <span class="text-sm text-gray-300">مرحباً،</span>
                            <span class="font-semibold mr-1" id="user-name">المستخدم</span>
                        </div>
                    </div>
                    <a href="admin-dashboard.html" id="dashboard-link" class="bg-gradient-to-r from-yellow-600 to-amber-600 text-white px-5 py-2 rounded-full font-semibold hover:from-yellow-700 hover:to-amber-700 transition duration-300 shadow-md text-sm">
                        <i class="fas fa-tachometer-alt mr-1"></i>
                        لوحة التحكم
                    </a>
                    <button id="logout-btn" class="border-2 border-yellow-600 text-yellow-600 px-5 py-2 rounded-full font-semibold hover:bg-yellow-600 hover:text-white transition duration-300 text-sm">
                        <i class="fas fa-sign-out-alt mr-1"></i>
                        تسجيل الخروج
                    </button>
                    <!-- Mobile Menu Button -->
                    <button class="md:hidden text-white text-2xl" id="mobile-menu-btn-auth">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div class="md:hidden mt-4 hidden" id="mobile-menu">
                <div class="flex flex-col space-y-4">
                    <a href="index.html" class="text-white hover:text-yellow-400 transition duration-300 font-medium py-2">الرئيسية</a>
                    <a href="places.html" class="text-white hover:text-yellow-400 transition duration-300 font-medium py-2">اصناف الطعام</a>
                    <a href="#" class="text-white hover:text-yellow-400 transition duration-300 font-medium py-2">وظائف</a>
                    <a href="customize.html" id="customize-restaurant-mobile" class="text-white hover:text-yellow-400 transition duration-300 font-medium py-2">خصص مطعمك</a>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-8 flex-1">
        <!-- صفحة اختيار نوع المنيو -->
        <div id="menuStylesSelection" class="hidden">
            <div class="flex items-center justify-between mb-8">
                <div class="flex items-center gap-3">
                    <a href="customize.html" class="w-10 h-10 rounded-full bg-white shadow flex items-center justify-center hover:bg-gray-100 transition">
                        <i class="fas fa-arrow-right"></i>
                    </a>
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800">اختر نوع المنيو</h1>
                </div>
                <a href="restaurant-owner-dashboard.html" class="text-sm text-gray-600 hover:text-gray-800">العودة للوحة التحكم</a>
            </div>

            <p class="text-gray-600 mb-8 text-center">اختر نوع المنيو الذي يناسب مطعمك. اضغط على الكارد للبدء في ملء طلب إنشاء المنيو.</p>

            <!-- Grid of Menu Style Cards -->
            <div id="menuStylesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards will be loaded here -->
                <div class="col-span-full text-center py-12">
                    <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-600"></div>
                    <p class="mt-4 text-gray-600">جاري تحميل أنواع المنيو...</p>
                </div>
            </div>
        </div>

        <!-- صفحة الفورم -->
        <div id="menuRequestFormSection" class="hidden">
            <div class="flex items-center justify-between mb-6">
                <div class="flex items-center gap-3">
                    <button onclick="goBackToSelection()" class="w-10 h-10 rounded-full bg-white shadow flex items-center justify-center hover:bg-gray-100 transition">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800">طلب تخصيص منيو</h1>
                </div>
                <a href="restaurant-owner-dashboard.html" class="text-sm text-gray-600 hover:text-gray-800">العودة للوحة التحكم</a>
            </div>

            <!-- Selected Menu Style Info -->
            <div id="selectedMenuStyleInfo" class="bg-gradient-to-r from-yellow-50 to-amber-50 rounded-xl p-6 mb-6 border border-yellow-200">
                <div class="flex items-center gap-4">
                    <div id="selectedMenuStyleImage" class="w-24 h-24 rounded-lg overflow-hidden bg-gray-200 flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-image text-gray-400 text-2xl"></i>
                    </div>
                    <div class="flex-1">
                        <h3 id="selectedMenuStyleName" class="text-xl font-bold text-gray-800 mb-1">نوع المنيو</h3>
                        <p id="selectedMenuStyleDescription" class="text-gray-600 text-sm"></p>
                    </div>
                </div>
            </div>

            <!-- Form -->
            <div class="bg-white rounded-xl shadow-md p-6">
                <p class="text-gray-600 mb-6">املأ البيانات التالية لإرسال طلب إنشاء منيو لمطعمك. سنقوم بالتواصل معك بعد المراجعة.</p>

                <form id="menuRequestForm" class="space-y-5">
                    <input type="hidden" id="selectedMenuStyleId" value="">

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">عنوان الطلب *</label>
                        <input type="text" id="title" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent" placeholder="مثال: إنشاء منيو رقمي لمطعم مشويات أبو مازن">
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">اسم المطعم *</label>
                            <input type="text" id="restaurantName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent" placeholder="اسم المطعم">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">اسم صاحب المطعم *</label>
                            <input type="text" id="ownerName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent" placeholder="اسمك الكامل">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">رقم الهاتف</label>
                        <input type="tel" id="ownerPhone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent" placeholder="+201234567890">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">تفاصيل إضافية</label>
                        <textarea id="additionalDetails" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent" placeholder="اكتب أي تفاصيل تريدها عن تصميم المنيو..."></textarea>
                    </div>

                    <button type="submit" class="w-full bg-gradient-to-r from-yellow-600 to-amber-600 text-white py-3 rounded-lg font-semibold hover:from-yellow-700 hover:to-amber-700 transition duration-300">
                        <i class="fas fa-paper-plane ml-2"></i> إرسال الطلب
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer (same as main site) -->
    <footer class="bg-gradient-to-r from-gray-900 to-black text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Company Info -->
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center space-x-3 space-x-reverse mb-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-yellow-600 to-amber-600 rounded-full flex items-center justify-center">
                            <i class="fas fa-utensils text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold">WeenRest</h3>
                    </div>
                    <p class="text-gray-300 mb-4 max-w-md">
                        منصة المطاعم الرائدة في سوريا. اكتشف أفضل المطاعم والعروض، أو أضف مطعمك وابدأ رحلتك معنا.
                    </p>
                    <div class="flex space-x-4 space-x-reverse">
                        <a href="#" class="text-yellow-400 hover:text-white transition duration-300">
                            <i class="fab fa-facebook text-2xl"></i>
                        </a>
                        <a href="#" class="text-yellow-400 hover:text-white transition duration-300">
                            <i class="fab fa-twitter text-2xl"></i>
                        </a>
                        <a href="#" class="text-yellow-400 hover:text-white transition duration-300">
                            <i class="fab fa-instagram text-2xl"></i>
                        </a>
                        <a href="#" class="text-yellow-400 hover:text-white transition duration-300">
                            <i class="fab fa-linkedin text-2xl"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h4 class="text-lg font-semibold mb-4">روابط سريعة</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-yellow-400 hover:text-white transition duration-300">عن الموقع</a></li>
                        <li><a href="#" class="text-yellow-400 hover:text-white transition duration-300">كيفية الاستخدام</a></li>
                        <li><a href="#" class="text-yellow-400 hover:text-white transition duration-300">الشروط والأحكام</a></li>
                        <li><a href="#" class="text-yellow-400 hover:text-white transition duration-300">سياسة الخصوصية</a></li>
                    </ul>
                </div>

                <!-- Contact Info -->
                <div>
                    <h4 class="text-lg font-semibold mb-4">تواصل معنا</h4>
                    <ul class="space-y-2">
                        <li class="flex items-center space-x-2 space-x-reverse">
                            <i class="fas fa-phone text-yellow-400"></i>
                            <span class="text-yellow-400">+20 123 456 7890</span>
                        </li>
                        <li class="flex items-center space-x-2 space-x-reverse">
                            <i class="fas fa-envelope text-yellow-400"></i>
                            <span class="text-yellow-400">info@weenrest.com</span>
                        </li>
                        <li class="flex items-center space-x-2 space-x-reverse">
                            <i class="fas fa-map-marker-alt text-yellow-400"></i>
                            <span class="text-yellow-400">دمشق، سوريا</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Bottom Bar -->
            <div class="border-t border-yellow-600 mt-8 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-yellow-400 text-sm">
                        © 2024 WeenRest. جميع الحقوق محفوظة.
                    </p>
                    <div class="flex space-x-6 space-x-reverse mt-4 md:mt-0">
                        <a href="#" class="text-yellow-400 hover:text-white text-sm transition duration-300">سياسة الخصوصية</a>
                        <a href="#" class="text-yellow-400 hover:text-white text-sm transition duration-300">الشروط والأحكام</a>
                        <a href="#" class="text-yellow-400 hover:text-white text-sm transition duration-300">تواصل معنا</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Header scripts (auth/menu behavior) -->
    <script>
        (function() {
            const token = localStorage.getItem('token');
            const userData = localStorage.getItem('user');
            const authButtons = document.getElementById('auth-buttons');
            const userInfo = document.getElementById('user-info');
            const userName = document.getElementById('user-name');
            const dashboardLink = document.getElementById('dashboard-link');

            if (token && userData) {
                try {
                    const user = JSON.parse(userData);
                    authButtons.classList.add('hidden');
                    userInfo.classList.remove('hidden');
                    const fullName = `${user.firstName || ''} ${user.lastName || ''}`.trim() || user.email || 'المستخدم';
                    userName.textContent = fullName;
                    if (user.role === 'admin') {
                        dashboardLink.href = 'admin-dashboard.html';
                    } else if (user.role === 'stakeholder') {
                        dashboardLink.href = 'restaurant-owner-dashboard.html';
                    } else {
                        dashboardLink.href = 'user-dashboard.html';
                    }
                } catch {
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                }
            } else {
                authButtons.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
        })();

        document.getElementById('logout-btn')?.addEventListener('click', function() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            setTimeout(() => { window.location.href = 'index.html'; }, 300);
        });

        document.getElementById('mobile-menu-btn')?.addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });
        document.getElementById('mobile-menu-btn-auth')?.addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });
    </script>

    <script>
        const API_BASE_URL = 'https://weenapp-001-site1.qtempurl.com/api';
        let menuStyles = [];

        document.addEventListener('DOMContentLoaded', async () => {
            const token = localStorage.getItem('token');
            if (!token) { window.location.href = 'login.html'; return; }

            // Load menu styles first
            await loadMenuStyles();

            // Check if we have a menuStyleId in URL
            const urlParams = new URLSearchParams(window.location.search);
            const menuStyleId = urlParams.get('menuStyleId');

            if (menuStyleId) {
                // Show form with selected menu style
                showFormWithMenuStyle(parseInt(menuStyleId));
            } else {
                // Show menu styles selection
                showMenuStylesSelection();
            }

            // Form submit handler
            document.getElementById('menuRequestForm').addEventListener('submit', submitRequest);
        });

        function showMenuStylesSelection() {
            document.getElementById('menuStylesSelection').classList.remove('hidden');
            document.getElementById('menuRequestFormSection').classList.add('hidden');
        }

        function showFormWithMenuStyle(menuStyleId) {
            const menuStyle = menuStyles.find(s => s.id === menuStyleId);
            if (!menuStyle) {
                // If menu style not found, go back to selection
                showMenuStylesSelection();
                return;
            }

            // Update selected menu style info
            const imageContainer = document.getElementById('selectedMenuStyleImage');
            if (menuStyle.imageUrl) {
                const imageUrl = menuStyle.imageUrl.startsWith('http') 
                    ? menuStyle.imageUrl 
                    : `https://weenapp-001-site1.qtempurl.com${menuStyle.imageUrl}`;
                imageContainer.innerHTML = `<img src="${escapeHtml(imageUrl)}" alt="${escapeHtml(menuStyle.name)}" class="w-full h-full object-cover">`;
            } else {
                imageContainer.innerHTML = '<i class="fas fa-image text-gray-400 text-2xl"></i>';
            }

            document.getElementById('selectedMenuStyleName').textContent = menuStyle.name;
            document.getElementById('selectedMenuStyleDescription').textContent = menuStyle.description || '';

            // Set hidden input
            document.getElementById('selectedMenuStyleId').value = menuStyleId;

            // Prefill owner info if saved
            try {
                const userStr = localStorage.getItem('user');
                if (userStr) {
                    const user = JSON.parse(userStr);
                    document.getElementById('ownerName').value = `${user.firstName || ''} ${user.lastName || ''}`.trim();
                }
            } catch {}

            // Prefill restaurant name when available
            fetch(`${API_BASE_URL}/RestaurantOwnerDashboard/restaurant`, {
                headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
            }).then(async r => {
                if (r.ok) {
                    const data = await r.json();
                    if (data && data.success && data.data) {
                        document.getElementById('restaurantName').value = data.data.name || '';
                        if (data.data.phoneNumber) document.getElementById('ownerPhone').value = data.data.phoneNumber;
                    }
                }
            }).catch(() => {});

            // Show form section
            document.getElementById('menuStylesSelection').classList.add('hidden');
            document.getElementById('menuRequestFormSection').classList.remove('hidden');
        }

        function goBackToSelection() {
            // Remove menuStyleId from URL
            const url = new URL(window.location.href);
            url.searchParams.delete('menuStyleId');
            window.history.pushState({}, '', url);
            showMenuStylesSelection();
        }

        async function loadMenuStyles() {
            try {
                const response = await fetch(`${API_BASE_URL}/Public/menu-styles`);
                const data = await response.json();
                const grid = document.getElementById('menuStylesGrid');
                
                if (data.success && data.data && data.data.length > 0) {
                    menuStyles = data.data;
                    grid.innerHTML = '';
                    
                    data.data.forEach(style => {
                        const card = document.createElement('div');
                        card.className = 'bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-all duration-300 cursor-pointer group';
                        card.onclick = () => {
                            const url = new URL(window.location.href);
                            url.searchParams.set('menuStyleId', style.id);
                            window.location.href = url.toString();
                        };

                        const imageUrl = style.imageUrl 
                            ? (style.imageUrl.startsWith('http') ? style.imageUrl : `https://weenapp-001-site1.qtempurl.com${style.imageUrl}`)
                            : null;

                        card.innerHTML = `
                            <div class="relative h-64 bg-gradient-to-br from-gray-100 to-gray-200 overflow-hidden">
                                ${imageUrl 
                                    ? `<img src="${escapeHtml(imageUrl)}" alt="${escapeHtml(style.name)}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300">`
                                    : `<div class="w-full h-full flex items-center justify-center">
                                        <i class="fas fa-image text-gray-400 text-6xl"></i>
                                       </div>`
                                }
                                <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                            </div>
                            <div class="p-6">
                                <h3 class="text-xl font-bold text-gray-800 mb-2 group-hover:text-yellow-600 transition-colors">${escapeHtml(style.name)}</h3>
                                ${style.description ? `<p class="text-gray-600 text-sm line-clamp-2">${escapeHtml(style.description)}</p>` : ''}
                                <div class="mt-4 flex items-center text-yellow-600 font-semibold">
                                    <span>اختر هذا النوع</span>
                                    <i class="fas fa-arrow-left mr-2 group-hover:mr-4 transition-all"></i>
                                </div>
                            </div>
                        `;
                        grid.appendChild(card);
                    });
                } else {
                    grid.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-inbox text-gray-400 text-5xl mb-4"></i>
                            <p class="text-gray-600 text-lg">لا توجد أنواع منيو متاحة حالياً</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading menu styles:', error);
                const grid = document.getElementById('menuStylesGrid');
                grid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="fas fa-exclamation-triangle text-red-400 text-5xl mb-4"></i>
                        <p class="text-red-600 text-lg">حدث خطأ في تحميل أنواع المنيو</p>
                        <button onclick="loadMenuStyles()" class="mt-4 px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition">
                            إعادة المحاولة
                        </button>
                    </div>
                `;
            }
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        async function submitRequest(e) {
            e.preventDefault();
            const token = localStorage.getItem('token');
            if (!token) { window.location.href = 'login.html'; return; }

            const menuStyleId = document.getElementById('selectedMenuStyleId').value;
            if (!menuStyleId) {
                Swal.fire({ icon: 'error', title: 'خطأ', text: 'يرجى اختيار نوع المنيو أولاً' });
                return;
            }

            const payload = {
                title: document.getElementById('title').value,
                restaurantName: document.getElementById('restaurantName').value,
                ownerName: document.getElementById('ownerName').value,
                ownerPhone: document.getElementById('ownerPhone').value || null,
                additionalDetails: document.getElementById('additionalDetails').value || null,
                menuStyleId: parseInt(menuStyleId)
            };

            try {
                const resp = await fetch(`${API_BASE_URL}/RestaurantOwnerMenuRequests`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
                    body: JSON.stringify(payload)
                });
                const data = await resp.json();
                if (data.success) {
                    Swal.fire({
                        icon: 'success',
                        title: 'تم إرسال الطلب',
                        text: 'سنتواصل معك بشأن بيانات المنيو وباقي الخطوات',
                        confirmButtonText: 'حسناً',
                        confirmButtonColor: '#f59e0b'
                    }).then(() => {
                        // Reset form and go back to selection
                        document.getElementById('menuRequestForm').reset();
                        goBackToSelection();
                    });
                } else {
                    Swal.fire({ 
                        icon: 'error', 
                        title: 'تعذر الإرسال', 
                        text: data.message || 'حاول مرة أخرى',
                        confirmButtonColor: '#f59e0b'
                    });
                }
            } catch (err) {
                Swal.fire({ 
                    icon: 'error', 
                    title: 'تعذر الإرسال', 
                    text: 'حدث خطأ غير متوقع',
                    confirmButtonColor: '#f59e0b'
                });
            }
        }
    </script>
</body>
</html>


